<html>
    <head>
	<title>淺色電腦 訂購單確認內容</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" type="text/css" href="css/header.css" />
	<link rel="stylesheet" type="text/css" href="css/orderCheck.css" />
    </head>
    <body>
	<div id="header">
	    <a href="index.html"><img src="imgs/cooltext143725226109873.png" /></a>
	    <div class="navi">
		<a href="#">主機板</a>
		<a href="#">處理器</a>
		<a href="#">硬碟</a>
		<a href="#">光碟機</a>
		<a href="#">記憶體</a>
		<a href="#">螢幕</a>
		<a href="#">電源供應器</a>
		<a href="#">顯示卡</a>
	    </div>
	</div>
	<div id="content">
	    <h2>購物車商品查看</h2>
	    <table id="cartShow">
	    </table>
	    <span>
		<label>運費：NT$ 120</label>
		<label>總計：NT$ 8310</label>
	    </span>
	    <form action="orderSpan" method="post" id="payResult">
		<div>
		    <h2>填寫收件人資料</h2>
		    <p>
		    <label>收件人姓名:</label>
		    <input type="text" name="buyName" />
		    </p>
		    <p>
		    <label>E-mail:</label>
		    <input type="text" name="buyEmail" />
		    </p>
		    <p>
		    <label>電話:</label>
		    <input type="text" name="buyTel" />
		    </p>
		    <p>
		    <label>地址:</label>
		    <select name="buyCity" />
			<option value="台北市">台北市</option>
			<option value="台中市">台中市</option>
			<option value="台南市">台南市</option>
		    </select>
		    <select name="buyArea" />
			<option value="測試區">測試區</option>
			<option value="北平區">北平區</option>
			<option value="輛長驅">輛長驅</option>
		    </select>
		    <input type="text" name="buyAddr" />
		    </p>
		</div>
		<div>
		    <h2>選擇付款方式</h2>
		    <p>
		    <label>付款方式:</label>
		    <input type="radio" name="payMode" value="atm" />ATM轉帳付款
		    <input type="text" name="atm_act5" />
		    </p>
		    <p>
		    <label>付費類型:</label>
		    <input type="hidden" name="shipMode" value="shipModeA" />
		    </p>
		    <p>
		    <label>發票開立:</label>
		    <input type="radio" name="invoice_type" value="personal" />個人
		    <input type="radio" name="invoice_type" value="company" />公司
		    </p>
		    <p>
		    <label>備註:</label>
		    <textarea name="memo"></textarea>
		    </p>
		</div>
		<div>
		    <button>結帳</button>
		</div>
	    </form>
	</div>
	<script id="prodCart" type="text/template">
	    <thead>
		<tr>
		    <td>商品分類</td>
		    <td>商品名稱</td>
		    <td>商品數量</td>
		    <td>商品小計</td>
		</tr>
	    </thead>
	    <tbody>
		<% _.each(cart, function(item) { %>
		<tr>
		    <td><%=item['p_cls']%></td>
		    <td><%=item['p_name']%></td>
		    <td><%=item['amount']%></td>
		    <td>NT$ <%=item['subTotal']%></td>
		</tr>
		<% }); %>
	    </tbody>
	</script>
	<div id="footer">
	</div>
    </body>
    <script src="lib/jquery-1.8.2.js"></script>
    <script src="lib/jquery.form.js"></script>
    <script src="lib/underscore.js"></script>
    <script src="lib/backbone.js"></script>
    <script src="cart/Cart.js"></script>
    <script>
	$(document).ready(function() {
	    var cartStore = new CartStore();
	    var cartv = new Cart({'el' : "#cartShow", 'model' : cartStore});
	    $("#payResult").submit(function() {
		var formArr = $(this).serializeArray();
		var postData = {};
		_.each(formArr, function(item) {
		    postData[item['name']] = item['value'];
		});
		postData['cart'] = cartStore.toJSON()['data'];
		postData['instr'] = "createOrder";
		console.log(postData);
		$.post("instr.php", postData, function(data) {
		    data = JSON.parse(data);
		    console.log(data);
		    if(data['status'] = 200) {
			cartStore.clear();
		    }
		});
		return false;
	    });
	});
    </script>
</html>

